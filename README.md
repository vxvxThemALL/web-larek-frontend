# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Данные и типы данных, используемых в приложении

Карточка

```
export interface ICard {
    id: string;
    description?: string;
    image: string;
    title: string;
    category: string;
    price: number | null;
}
```

Интерфейс для хранения коллекции карточек главной страницы

```
export interface ICardsData {
    cards: ICard[];
    preview: string | null;
}
```

Интерфейс для хранения коллекции карточек корзины

```
export interface IBasket {
    cards: IBasketItem[];
    totalPrice: number;
}
```

Карточка корзины 

```
export type TBasketCard = Pick<ICard, 'id' | 'title' | 'price'>;
```

Интерфейс для заполнения данных формы способа оплаты и доставки

```
export interface IDeliveryForm {
    deliveryMethod: string;
    address: string;
    checkValidation(data: string): boolean;
}
```

Интерфейс для заполнения данных формы контактной информации

```
export interface IContactForm {
    email: string;
    phone: string;
}
```

Окно об успешном заказе

```
export interface ISuccess {
    totalPrice: number;
}
```

## Архитектура приложения

Код приложения разделен на слои согласно парадигме MVP:
- слой представления - отвечает за отображение данных на странице;
- слой данных -  отвечает за хранение и изменение данных;
- презентер - отвечает за связь представления и данных.

### Базовый код

#### Класс Api
Содержит в себе базовую логику отправки запросов. В конструктор передается базовый адрес сервера и опциональный объект с заголовками запросов.
Методы:
- `get` - выполняет GET запрос на переданный в параметрах ендпоинт и возвращает промис с объектом, которым ответил сервер;
- `post` - принимает объект с данными, которые будут переданы в JSON в теле запроса, и отправляет эти данные на ендпоинт, переданный как параметр при вызове метода. По умолчанию выполняет `POST` запрос, но метод запроса может быть переопределен заданием третьего параметра при вызове.

#### Класс EventEmitter
Брокер событий позволяет отправлять события и подписываться на события, происходящие в системе. Класс используется в презентере для обработки событий и в слоях приложения для генерации событий.
Основные методы, реализуемые классом описаны интерфейсом `IEvents`:
- `on` - подписка на события;
- `emit` - инициализация события;
- `trigger` - возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие.

### Слой данных

#### Класс CardsData
Класс отвечает за хранение и логику работы с данными карточек главной страницы.\
Конструктор класса принимает инстанс брокера событий.\
В полях класса хранятся следующие данные:
- _cards: ICard[] - массив объектов карточек;
- _preview: string | null - id карточки, выбранной для просмотра в модальном окне;
- events: IEvents - экземпляр класса `EventEmitter` для инициализации событий при изменении данных.

Также класс предоставляет набор методов для взаимодействия с этими данными:
- addCards(card: ICard[]): void - добавляет массив карточек;
- getCard(cardId: string): ICard - возвращает карточку по ее id;
- а также сеттеры и геттеры для сохранения и получения данных из полей класса.

#### Класс Basket
Класс отвечает за хранение и логику работы с данными карточек корзины.\
Конструктор класса принимает инстанс брокера событий.\
В полях класса хранятся следующие данные:
- _cards: TBasketCard[] - массив объектов карточек;
- events: IEvents - экземпляр класса `EventEmitter` для инициализации событий при изменении данных.

Также класс предоставляет набор методов для взаимодействия с этими данными:
- addCard(card: ICard): void - добавляет одну карточку в начало массива;
- removeCard(cardId: string): void - удаляет одну карточку из массива;
- а также сеттеры и геттеры для сохранения и получения данных из полей класса.